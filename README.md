# FaceRadar
 Project to detect faces from webcam

# Установка
## Необходимые модули
- cv2 (opencv-python)
- face_recognition (+dlib)
- requests
- sys
- argparse

Рекомендуемая версия python 3.8.5

## Установка модулей
Чтобы установить модуль, используйте консольную команду:
pip install имя модуля
или
запустить setup.py

# Параметры
Доступные параметры (в скобках название переменной и значение по умолчанию):
- wc индекс локальной камеры или адрес веб-камеры (webcam = 0)
- ud адрес url сервера, на который отправляются распознанные лица (urlDist = "http://127.0.0.1:8000")
- kf порог распознавания лица: доля по среднему арифметическому отношений ширины и высоты к экрану (kMinFace = 0.01)
- md максимальное расстояние между центрами лиц, при котором они считаются одним. Измеряется в долях по отношению к наименьшей стороне прямоугольника лица (maxDistance = 0.9)
- kp частота обработки кадров: количество кадров, которые будут пропущены между обрабатываемыми кадрами. Напрямую влияет на производитедбность (kadrToProcess = 100)
- ke количество кадров, в течение которых прежние положения лиц будут храниться в памяти для трекинга (maxKadrEmpty = 50)
- iw количество непринятых кадров до завершения программы (maxInAccessWebcam = 1)
- kx, ky коэффициенты масштабирования изображения перед обработкой, умножаются на стороны прямоугольника исходного изображения (kx = 0.5, ky = 0.5)

## В редакторе python
Можно настроить необходимые параметры в качестве значений по умолчанию в файле ConsoleArgParse

## В консоли
Пример:
python main.py -wc "rtsp://nikname:password@123.456.789.000:0000/ISAPI/Streaming/Channels/101" -kf 0.15 -kx 1 -ky 1

## Примечание
Окно закрывается клавишей Esc, консоль сочетанием Ctrl+C

# Настройка параметров
## Основные задачи
Если нужна скорость обработки (снизить нагрузку на оборудование):
- Уменьшить kx, ky. Теряется качество изображения и дистанция обнаружения лиц.
- увеличить kadrToProcess. Теряется качество трекинга, возможно генерирование лишних лиц.

Если нужна вероятность обнаружения:
- увеличить kx, ky (вплоть до 1). Теряется скорость обработки (увеличивается нагрузка)
- уменьшить kMinFace. Возможны ложные срабатывания на бейджики.

Если нужно улучшить трекинг (уменьшить вероятность повторной отправки):
- уменьшить kadrToProcess. Теряется скорость обработки (увеличивается нагрузка)
- увеличить maxDistance. Уменьшается вероятность обнаружения новых людей, есть риск перепутать их со старыми
- увеличить maxKadrEmpty. Уменьшается вероятность обнаружения новых людей, есть риск перепутать их со старыми

## Прикладные задачи:

Если нужно отследить людей, которые быстро передвигаются:
- улучшить трекинг (со всеми последствиями)
- увеличить kx, ky (вплоть до 1). Теряется скорость обработки (увеличивается нагрузка)

Если нужно отследить людей вдали:
- увеличить kx, ky (вплоть до 1). Теряется скорость обработки (увеличивается нагрузка)

## Примечания:
- коэффициенты kx, ky влияют на изображение при обработке. На качество отправляемого лица они не влияют, отправляемое лицо вырезается из исходного изображения.


